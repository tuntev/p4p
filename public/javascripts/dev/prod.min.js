var createAccountApp=angular.module("createAccount",["ngRoute","ngSanitize"],["$interpolateProvider",function(a){a.startSymbol("<%"),a.endSymbol("%>")}]);createAccountApp.config(["$routeProvider",function(){}]);var app=angular.module("app",["ngRoute","ngSanitize","ui.bootstrap","dialogs.main","app.directives"],["$interpolateProvider",function(a){a.startSymbol("<%"),a.endSymbol("%>")}]);app.config(["$routeProvider",function(a){a.when("/home",{templateUrl:"templates/home.html",controller:"HomeController"}),a.when("/projects",{templateUrl:"templates/projects.html",controller:"ProjectsController"}),a.when("/projects/:projectId",{templateUrl:"templates/project_details.html",controller:"ProjectDetailsController"}),a.when("/todo",{templateUrl:"templates/todos.html",controller:"TodoController"}),a.when("/demo",{templateUrl:"templates/demo.html",controller:"DemoController"}),a.when("/chat",{templateUrl:"templates/chat.html",controller:"ChatController"}),a.otherwise({redirectTo:"/home"})}]),$(document).ready(function(){switch($("form").on("submit",function(){$("button:submit").attr("disabled",!0)}),$(".navbar-nav").find(".active").removeClass("active"),window.location.pathname){case"/Prog4Projects/public/prog4":$("#coursesNav").addClass("active");break;case"/Prog4Projects/public/users":case"/Prog4Projects/public/user/createNew":$("#adminNav").addClass("active")}$(".jsDelete").click(function(a){a.stopPropagation();var b=confirm("Are you sure");return 0==b?void a.preventDefault():void 0})}),app.directive("ngConfirmClick",[function(){return{link:function(a,b,c){var d=c.ngConfirmClick||"Are you sure?",e=c.confirmedClick;b.bind("click",function(){window.confirm(d)&&a.$eval(e)})}}}]),createAccountApp.directive("validPasswordC",function(){return{require:"ngModel",link:function(a,b,c,d){d.$parsers.unshift(function(b){var c=b!=a.myForm.password.$viewValue;d.$setValidity("noMatch",!c)})}}}),app.directive("ngEnter",function(){return function(a,b,c){b.bind("keydown keypress",function(b){13===b.which&&(a.$apply(function(){a.$eval(c.ngEnter)}),b.preventDefault())})}}),app.service("GetTodos",["$http",function(a){return{getData:function(){return a.get("todos").then(function(a){return a.data})}}}]),app.service("ProjectsService",["$http","$sanitize",function(a,b){return{getProjects:function(){return a.get("api/p4p").then(function(a){return a.data})},updateDone:function(b,c){return a.put("api/p4p/"+b,{done:c}).success(function(a){return a?a:void 0}).error(function(a,b){console.log("status: "+b)})},sanitizeInput:function(a){return{title:b(a.title),student:b(a.student),csrf_token:b($('meta[name="csrf-token"]').attr("content"))}},addNew:function(b){return a.post("api/p4p",b).then(function(a){return a.data})},"delete":function(b){return a.delete("api/p4p/"+b).error(function(a,b){console.log(b)})},getProjectById:function(b){return a.get("api/p4p/"+b).then(function(a){return a.data})}}}]),app.service("TabService",function(){return{setTab:function(a){var b=$("#tabs").find(".active");b.removeClass(),$("#ng-tab"+a).addClass("active")}}}),app.service("UserService",["$http",function(a){return{getUser:function(b){return a.get("api/users/"+b).then(function(a){return a.data})}}}]),app.controller("ChatController",["TabService","$scope","UserService","$sanitize",function(a,b,c,d){a.setTab(5);var e=($(".chat textarea"),$(".chat-status span")),f=e.text(),g=$(".chat-messages"),h=function(a){if(e.text(a),a!==f)var b=setTimeout(function(){h(f),clearInterval(b)},3e3)};c.getUser(b.id_user).then(function(a){b.nickname=a.email});try{var i=io.connect("http://localhost:1133")}catch(j){}void 0!==i?(b.sendMsg=function(){b.message&&i.emit("input",{nickname:d(b.nickname),message:d(b.message)})},i.emit("userConnected"),i.on("output",function(a){a.length&&(console.log(a[0]),a[0].created_at=b.prettyDate(a[0].created_at),b.messages.push(a[0]),b.$apply(),g.animate({scrollTop:"3000px"}))}),i.on("status",function(a){h("object"==typeof a?a.message:a),a.clear===!0&&(b.message="",b.$apply())}),i.on("loaded_msgs",function(a){var c;for(b.messages=a,c=0;c<b.messages.length;c++)b.messages[c].created_at=b.prettyDate(b.messages[c].created_at);b.$apply()}),i.on("delete_msg_resp",function(a){b.messages=b.messages.filter(function(b){return b.id!=a}),b.$apply()})):($(".theMessage").attr("disabled","disabled"),$(".theMessage").attr("placeholder","Chat unavailable")),b.$on("$destroy",function(){i.removeAllListeners()}),b.prettyDate=function(a){return $.format.date(a,"dd/MM/yyyy HH:mm:ss")},b.deleteMsg=function(a){i.emit("delete_msg_req",a)}}]),app.controller("DemoController",["TabService","$scope","$http",function(a,b,c){a.setTab(4),b.toggle=!1,b.drawResult=function(a){a.length>0?(c.get("javascripts/data.json").success(function(a){b.data=a}),b.toggle||(b.toggle=!0,$(".searchOut").slideToggle())):(b.data={},b.visible=!1,b.toggle&&(b.toggle=!1,$(".searchOut").slideToggle()))},b.showContent=function(a){$(".searchOut").slideToggle(),b.toggle=!1,b.visible=!0,b.contactData={id:a,name:"Ime Prezime",info:""}}}]),app.controller("HomeController",["$scope","TabService",function(a,b){b.setTab(1)}]),app.controller("ProjectDetailsController",["$scope","$routeParams","TabService","ProjectsService","$location",function(a,b,c,d,e){c.setTab(2);var f=b.projectId;d.getProjectById(f).then(function(b){return b.message?void e.path("/projects"):void(a.project=b)})}]),app.controller("ProjectsController",["$scope","ProjectsService","TabService","$rootScope","$timeout","dialogs",function(a,b,c,d,e,f){c.setTab(2),b.getProjects().then(function(b){a.projects=b;var c;for(c=0;c<a.projects.length;c++)a.projects[c].updated_at=$.format.prettyDate(a.projects[c].updated_at)}),a.changeDone=function(a,c){var d;b.updateDone(a,c).then(function(a){d=a.data,$("#pID"+d).find(".dateInfo").html($.format.prettyDate(new Date)),$(".cnfBtn_"+d).hide()})},a.data={title:"",student:""},a.addNew=function(){if(""!==a.data.title&&""!==a.data.student){var c=b.sanitizeInput(a.data);b.addNew(c).then(function(a){c.id=a,c.updated_at=$.format.prettyDate(new Date)}),a.projects.unshift(c),a.data.title="",a.data.student=""}},a.removeChecked=function(){a.projects=_.filter(a.projects,function(a){return a.selected&&b.delete(a.id),!a.selected})},a.selected=function(){var b=0;return angular.forEach(a.projects,function(a){b+=a.selected?0:1}),b},a.launch=function(b,c,d){switch(b){case"error":f.error();break;case"wait":var e=f.wait(void 0,void 0,_progress);g();break;case"customwait":var e=f.wait("Custom Wait Header","Custom Wait Message",_progress);g();break;case"notify":f.notify();break;case"confirm":if("delete"===c&&a.selected()!==a.projects.length){var e=f.confirm("Confirm","Are you sure that you want to delete the selected projects?");e.result.then(function(){a.removeChecked()},function(){})}if("close"===c){var e=f.confirm("Confirm","Are you sure that you want to finish the project?");e.result.then(function(){a.changeDone(d,"1")},function(){})}break;case"custom":var e=f.create("/dialogs/custom.html","customDialogCtrl",{},{size:"lg",keyboard:!0,backdrop:!1,windowClass:"my-class"});e.result.then(function(b){a.name=b},function(){angular.equals(a.name,"")&&(a.name="You did not enter in your name!")});break;case"custom2":var e=f.create("/dialogs/custom2.html","customDialogCtrl2",a.custom,{size:"lg"})}};var g=function(){e(function(){100>_progress?(_progress+=33,d.$broadcast("dialogs.wait.progress",{progress:_progress}),g()):(d.$broadcast("dialogs.wait.complete"),_progress=33)},1e3)}}]),app.controller("TodoController",["$http","$scope","GetTodos","TabService",function(a,b,c,d){d.setTab(3),c.getData().then(function(a){b.todos=a}),b.remaining=function(){var a=0;return angular.forEach(b.todos,function(b){a+=b.done?0:1}),a},b.addNew=function(){var c={text:b.todotxt,done:!1,csrf_token:$('meta[name="csrf-token"]').attr("content")};b.todos.push(c),b.todotxt="",a.post("todos",c)},b.removeChecked=function(){b.todos=_.filter(b.todos,function(b){return b.done&&a.delete("todos/delete/"+b.id).error(function(a,b){console.log(b)}),!b.done})},b.toggleDone=function(c,d){a.put("todos/update/"+c,{done:d}).success(function(a,c){console.log(a?b.todos:"There was a problem. Status: "+c+"; Data: "+a)}).error(function(a,b){console.log("status: "+b)})}}]),angular.module("app.directives",[]).directive("newMessage",function(){return{restrict:"E",scope:{message:"=data"},templateUrl:"templates/chat/message.html",controller:function(){}}}).directive("singleProject",function(){return{restrict:"E",templateUrl:"templates/projects/project.html",scope:{project:"=",access:"="}}}).directive("contactCard",function(){return{restrict:"E",templateUrl:"templates/contacts/contact.html",scope:{contactData:"="}}});